<?xml version = "1.0" encoding = "utf-8"?>

<html>
	<head>
		<title> Drag and drop </title>
 		<link rel="stylesheet" type="text/css" href="./jigsaw.css" />
		<script type="text/javascript" src = "./jigsaw.js"></script>
		<script type="text/javascript">
			var imDirPaths, imageArray, imFileNames;
				

			function getRow(n) {
				var row = Math.floor((n / 4));
				return row;
			}

			function getColumn(n) {
				var column = n % 4;
				return column;
			}
		
			function getRowColumn(imStr, row, col) {
				var dotIdx = imStr.lastIndexOf(".");
				var imNum = imStr.charAt(dotIdx - 1);
				if(imNum == 0 || imNum == 1 || imNum == 2) {
					var tenPlace = imStr.charAt(dotIdx - 2);
					if(tenPlace == 1) {
						imNum = imNum + 10;
					}
				}
				alert(imNum);

				row = getRow(imNum);
				col = getColumn(imNum);
			}

			function getImageNum(imStr) {
				var dotIdx = imStr.lastIndexOf(".");
				var imNum = imStr.charAt(dotIdx - 1);
				if(imNum == 0 || imNum == 1 || imNum == 2) {
					var tenPlace = imStr.charAt(dotIdx - 2);
					if(tenPlace == 1) {
						if(imNum == 0) {
							imNum = 10;
						} else if(imNum == 1) {
							imNum = 11;
						} else {
							imNum = 12;
						}
					}
				}
				return imNum;
			}	

			function getRandFileNames() {
				var randIdx = Math.random() * 3;
				randIdx = Math.floor(randIdx);
				var rplus = randIdx + 1;
				var randStr = rplus.toString();
				var imString = new String();
				for(var i = 0; i < 12; ++i) {
					var iSt = new String((i + 1));
					imString = imDirPaths[randIdx];
					imString += "img" + randStr + "-" + iSt + ".jpg";
					imFileNames[i] = imString;
				}
			}

			function placeImage(imElem) {
				document.getElementById("grid_area").appendChild(imElem);
				var xCoord = imElem.x;
				var yCoord = imElem.y;
				imElem.style.left = xCoord.toString() + "px";
				imElem.style.top = yCoord.toString() + "px";
			
			}
		
			function createNewImage(imSrc) {
				var imNum = getImageNum(imSrc);
				var n = new Number(imNum);
				n = n - 1;
				var row = Math.floor(n / 4);
				var col = n % 4;
				var width = 100;
				var height = 100;
				var xCoord = 150 + (col * width);
				var yCoord = 150 + (row * height);
				var imId = "im_" + imNum.toString();
				var img = new Image();
				img.type = "image";
				img.name = imNum.toString();
				img.id = imId;
				img.src = imSrc;
				img.row = row;
				img.column = col;	
				img.x = xCoord;
				img.y = yCoord;
				img.width = width;
				img.height = height;
				img.draggable = true;
				img.onmousedown = "grabber(event);";
				img.onload = function() {
					placeImage( img );		
				}	
				return img;
			}
			
			function loadImages() {
				getRandFileNames();
				for(var i = 0; i < 12; ++i) {
					imageArray[i] = createNewImage(imFileNames[i]);
				}
			}

			function init() {
				imDirPaths = new Array(3);
				imDirPaths[0] = "./Images/images1/";
				imDirPaths[1] = "./Images/images2/";
				imDirPaths[2] = "./Images/images3/";
				
				imageArray = new Array(12);
				imFileNames = new Array(12);

				loadImages();

				var imAttribs = imageArray[6].attributes;

				document.getElementById("testInfo").innerHTML += "imAttribs.length: " + imAttribs.length;
				for(var i = 0; i < imAttribs.length; ++i) {
					document.getElementById("testInfo").innerHTML += "attrib " + i + " " + imAttribs[i].value + "<br>";
				}
			}
		</script>
	</head>

	<body onload="init()">
		<p id="testInfo">
			put stuff here
		</p>
		<div id="grid_area" style="position: absolute; top:100px; left:100px;" width="400" height="100">
			<img style="position: absolute; top:100px; left:100px;" src="./Images/images1/puzzleback.gif" width="400" height="300" />
		</div>
	</body>
</html>
